

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Video using the Base Overlay &mdash; Python productivity for Zynq (Pynq) v1.0</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Python productivity for Zynq (Pynq) v1.0" href="index.html"/>
        <link rel="next" title="Audio using the Base Overlay" href="9c_base_overlay_audio.html"/>
        <link rel="prev" title="Using Peripherals with the Base overlay" href="9a_base_overlay_iop.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Python productivity for Zynq (Pynq)
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="1_getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_pynq.html">PYNQ Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_jupyter_notebook.html">Jupyter Notebook Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="4_programming_python.html">Cortex-A9 programming in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="5_programming_onboard.html">Programming PYNQ-Z1&#8217;s onboard peripherals</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_overlays.html">Introduction to Overlays</a></li>
<li class="toctree-l1"><a class="reference internal" href="7_iop_architecture.html">IO Processor Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="8_iop_code.html">IO Processors: Writing Your Own Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="9a_base_overlay_iop.html">Using Peripherals with the Base overlay</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Video using the Base Overlay</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Video-IO">Video IO</a></li>
<li class="toctree-l2"><a class="reference internal" href="#The-HDMI-video-capture-controller">The HDMI video capture controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Starting-and-stopping-the-controller">Starting and stopping the controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Readback-from-the-controller">Readback from the controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="#HDMI-Frame-list">HDMI Frame list</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Access-the-current-frame">Access the current frame</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Frame-Lists">Frame Lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="#The-HDMI-out-controller">The HDMI out controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Input/Output-Frame-Lists">Input/Output Frame Lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Streaming-from-HDMI-Input-to-Output">Streaming from HDMI Input to Output</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="9c_base_overlay_audio.html">Audio using the Base Overlay</a></li>
<li class="toctree-l1"><a class="reference internal" href="10_creating_overlays.html">Creating Overlays</a></li>
<li class="toctree-l1"><a class="reference internal" href="11_python_package.html"><code class="docutils literal"><span class="pre">pynq</span></code> Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="12_verification.html">Verification</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html"><code class="docutils literal"><span class="pre">pynq</span></code> package reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="14_faqs.html">Frequently Asked Questions (FAQs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="15_glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="16_references.html">Useful Reference Links</a></li>
<li class="toctree-l1"><a class="reference internal" href="17_appendix.html">Appendix</a></li>
<li class="toctree-l1"><a class="reference internal" href="18_changelog.html">Documentation Changelog</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Python productivity for Zynq (Pynq)</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Video using the Base Overlay</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/9b_base_overlay_video.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput > div,
div.nbinput div[class^=highlight],
div.nbinput div[class^=highlight] pre,
div.nboutput,
div.nboutput > div,
div.nboutput div[class^=highlight],
div.nboutput div[class^=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput > :first-child pre {
    color: navy;
}

/* output prompt */
div.nboutput > :first-child pre {
    color: darkred;
}

/* all prompts */
div.nbinput > :first-child[class^=highlight],
div.nboutput > :first-child[class^=highlight],
div.nboutput > :first-child {
    min-width: 11ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}

/* input/output area */
div.nbinput > :nth-child(2)[class^=highlight],
div.nboutput > :nth-child(2),
div.nboutput > :nth-child(2)[class^=highlight] {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
}

/* input area */
div.nbinput > :nth-child(2)[class^=highlight] {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput  > :nth-child(2).stderr {
    background: #fdd;
}

/* ANSI colors */
.ansiblack { color: black; }
.ansired { color: darkred; }
.ansigreen { color: darkgreen; }
.ansiyellow { color: #c4a000; }
.ansiblue { color: darkblue; }
.ansipurple { color: darkviolet; }
.ansicyan { color: steelblue; }
/* See https://github.com/jupyter/nbconvert/issues/174 */
.ansigray { color: gray; }  /* nbconvert CSS */
.ansigrey { color: gray; }  /* nbconvert HTML output */

.ansibgblack { background-color: black; }
.ansibgred { background-color: red; }
.ansibggreen { background-color: green; }
.ansibgyellow { background-color: yellow; }
.ansibgblue { background-color: blue; }
.ansibgpurple { background-color: magenta; }
.ansibgcyan { background-color: cyan; }
.ansibggray { background-color: gray; }

.ansibold { font-weight: bold; }
</style>
<div class="section" id="Video-using-the-Base-Overlay">
<h1>Video using the Base Overlay<a class="headerlink" href="#Video-using-the-Base-Overlay" title="Permalink to this headline">¶</a></h1>
<p>The PYNQ-Z1 board contains a HDMI input port, and a HDMI output port
connected to the FPGA fabric of the Zynq® chip. This means to use the
HDMI ports, HDMI controllers must be included in a hardware library or
overlay.</p>
<p>The base overlay contains a HDMI input controller, and a HDMI Output
controller, both connected to their corresponding HDMI ports. A frame
can be captured from the HDMI input, and streamed into DDR memory. The
frames in DDR memory, can be accessed from Python.</p>
<p>A framebuffer can be shared between HDMI in and HDMI out to enable
streaming.</p>
<div class="figure align-center">
<img alt="_images/pynqz1_video.JPG" src="_images/pynqz1_video.JPG" />
</div>
<div class="section" id="Video-IO">
<h2>Video IO<a class="headerlink" href="#Video-IO" title="Permalink to this headline">¶</a></h2>
<p>The overlay contains two video controllers, HDMI in and out. Both
interfaces can be controlled independently, or used in combination to
capture an image from the HDMI, process it, and display it on the HDMI
out.</p>
<p>There is also a USB controller connected to the Zynq PS. A webcam can
also be used to capture images, or video input, that can be processed
and displayed on the HDMI out.</p>
</div>
<div class="section" id="The-HDMI-video-capture-controller">
<h2>The HDMI video capture controller<a class="headerlink" href="#The-HDMI-video-capture-controller" title="Permalink to this headline">¶</a></h2>
<p>To use the HDMI in controller, connect the on-board HDMI In port to a
valid video source. E.g. your laptop can be used if it has HDMI out. Any
HDMI video source can be used up to 1080p.</p>
<p>To use the HDMI in, ensure you have connected a valid HDMI source and
execute the next cell. If a valid HDMI source is not detected, the HDMI
in controller will timeout with an error.</p>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pynq</span> <span class="k">import</span> <span class="n">Overlay</span>
<span class="kn">from</span> <span class="nn">pynq.drivers.video</span> <span class="k">import</span> <span class="n">HDMI</span>

<span class="c1"># Download bitstream</span>
<span class="n">Overlay</span><span class="p">(</span><span class="s2">&quot;base.bit&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">download</span><span class="p">()</span>

<span class="c1"># Initialize HDMI as an input device</span>
<span class="n">hdmi_in</span> <span class="o">=</span> <span class="n">HDMI</span><span class="p">(</span><span class="s1">&#39;in&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The HDMI() argument ‘in’ indicates that the object is in capture mode.</p>
<p>When a valid video input source is connected, the controller should
recognize it and start automatically. If a HDMI source is not connected,
the code will time-out with an error.</p>
</div>
<div class="section" id="Starting-and-stopping-the-controller">
<h2>Starting and stopping the controller<a class="headerlink" href="#Starting-and-stopping-the-controller" title="Permalink to this headline">¶</a></h2>
<p>You can manually start/stop the controller</p>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">hdmi_in</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">hdmi_in</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Readback-from-the-controller">
<h2>Readback from the controller<a class="headerlink" href="#Readback-from-the-controller" title="Permalink to this headline">¶</a></h2>
<p>To check the state of the controller:</p>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">state</span> <span class="o">=</span> <span class="n">hdmi_in</span><span class="o">.</span><span class="n">state</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="container">
</div>
<div class="container">
<div class="highlight"><pre>
2
</pre></div></div>
</div>
<p>The state is returned as an integer value, with one of three possible
values:</p>
<ul class="simple">
<li>0 if disconnected</li>
<li>1 if streaming</li>
<li>2 if paused</li>
</ul>
<p>You can also check the width and height of the input source (assuming a
source is connected):</p>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">hdmi_in</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

<span class="n">width</span> <span class="o">=</span> <span class="n">hdmi_in</span><span class="o">.</span><span class="n">frame_width</span><span class="p">()</span>
<span class="n">height</span> <span class="o">=</span> <span class="n">hdmi_in</span><span class="o">.</span><span class="n">frame_height</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;HDMI is capturing a video source of resolution </span><span class="si">{}</span><span class="s1">x</span><span class="si">{}</span><span class="s1">&#39;</span>\
      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="p">,</span><span class="n">height</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="container">
</div>
<div class="container">
<div class="highlight"><pre>
HDMI is capturing a video source of resolution 1920x1080
</pre></div></div>
</div>
</div>
<div class="section" id="HDMI-Frame-list">
<h2>HDMI Frame list<a class="headerlink" href="#HDMI-Frame-list" title="Permalink to this headline">¶</a></h2>
<p>The HDMI object holds a frame list, that can contain up to 3 frames, and
is where the controller stores the captured frames. At the object
instantiation, the current frame is the one at index 0. You can check at
any time which frame index is active:</p>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">hdmi_in</span><span class="o">.</span><span class="n">frame_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>Out[6]:
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre>
<span></span>0
</pre></div>
</div>
</div>
<p>The <code class="docutils literal"><span class="pre">frame_index()</span></code> method can also be used to set a new index, if you
specify an argument with the method call. For instance:</p>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">index</span> <span class="o">=</span> <span class="n">hdmi_in</span><span class="o">.</span><span class="n">frame_index</span><span class="p">()</span>
<span class="n">hdmi_in</span><span class="o">.</span><span class="n">frame_index</span><span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This will set the current frame index to the next in the sequence. Note
that, if <code class="docutils literal"><span class="pre">index</span></code> is 2 (the last frame in the list), <code class="docutils literal"><span class="pre">(index+1)</span></code> will
cause an exception.</p>
<p>If you want to set the next frame in the sequence, use:</p>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">hdmi_in</span><span class="o">.</span><span class="n">frame_index_next</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>Out[8]:
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre>
<span></span>2
</pre></div>
</div>
</div>
<p>This will loop through the frame list and it will also return the new
index as an integer.</p>
<div class="section" id="Access-the-current-frame">
<h3>Access the current frame<a class="headerlink" href="#Access-the-current-frame" title="Permalink to this headline">¶</a></h3>
<p>There are two ways to access pixel data: <code class="docutils literal"><span class="pre">hdmi.frame()</span></code> and
<code class="docutils literal"><span class="pre">hdmi.frame_raw()</span></code>.</p>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span>

<span class="n">frame</span> <span class="o">=</span> <span class="n">hdmi_in</span><span class="o">.</span><span class="n">frame</span><span class="p">()</span>
<span class="n">orig_img_path</span> <span class="o">=</span> <span class="s1">&#39;/home/xilinx/jupyter_notebooks/Getting_Started/images/hdmi_in_frame0.jpg&#39;</span>
<span class="n">frame</span><span class="o">.</span><span class="n">save_as_jpeg</span><span class="p">(</span><span class="n">orig_img_path</span><span class="p">)</span>
<span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">orig_img_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>Out[9]:
</pre></div>
</div>
<div class="container">
<img alt="_images/9b_base_overlay_video_21_0.jpg" src="_images/9b_base_overlay_video_21_0.jpg" />
</div>
</div>
<p>This will dump the frame as a list <code class="docutils literal"><span class="pre">_frame[height,</span> <span class="pre">width][rgb]</span></code>. Where
<code class="docutils literal"><span class="pre">rgb</span></code> is a tuple <code class="docutils literal"><span class="pre">(r,g,b)</span></code>. If you want to modify the green
component of a pixel, you can do it as shown below. In the example, the
top left quarter of the image will have the green component increased.</p>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">height</span><span class="o">/</span><span class="mi">2</span><span class="p">)):</span>
        <span class="p">(</span><span class="n">red</span><span class="p">,</span><span class="n">green</span><span class="p">,</span><span class="n">blue</span><span class="p">)</span> <span class="o">=</span> <span class="n">frame</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span>
        <span class="n">green</span> <span class="o">=</span> <span class="n">green</span><span class="o">*</span><span class="mi">2</span>
        <span class="k">if</span><span class="p">(</span><span class="n">green</span><span class="o">&gt;</span><span class="mi">255</span><span class="p">):</span>
            <span class="n">green</span> <span class="o">=</span> <span class="mi">255</span>
        <span class="n">frame</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">red</span><span class="p">,</span> <span class="n">green</span><span class="p">,</span> <span class="n">blue</span><span class="p">)</span>

<span class="n">new_img_path</span> <span class="o">=</span> <span class="s1">&#39;/home/xilinx/jupyter_notebooks/Getting_Started/images/hdmi_in_frame1.jpg&#39;</span>
<span class="n">frame</span><span class="o">.</span><span class="n">save_as_jpeg</span><span class="p">(</span><span class="n">new_img_path</span><span class="p">)</span>
<span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">new_img_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>Out[10]:
</pre></div>
</div>
<div class="container">
<img alt="_images/9b_base_overlay_video_23_0.jpg" src="_images/9b_base_overlay_video_23_0.jpg" />
</div>
</div>
<p>This frame() method is a simple way to capture pixel data, but
processing it in Python will be slow. If you want to dump a frame at a
specific index, just pass the index as an argument of the <code class="docutils literal"><span class="pre">frame()</span></code>
method:</p>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># dumping frame at index 2</span>
<span class="n">frame</span> <span class="o">=</span> <span class="n">hdmi_in</span><span class="o">.</span><span class="n">frame</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>If higher performance is required, the <code class="docutils literal"><span class="pre">frame_raw()</span></code> method can be
used:</p>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [12]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># dumping frame at current index</span>
<span class="n">frame_raw</span> <span class="o">=</span> <span class="n">hdmi_in</span><span class="o">.</span><span class="n">frame_raw</span><span class="p">()</span>

<span class="c1"># dumping frame at index 2</span>
<span class="n">frame_raw</span> <span class="o">=</span> <span class="n">hdmi_in</span><span class="o">.</span><span class="n">frame_raw</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This method will return a fast memory dump of the internal frame list,
as a mono-dimensional list of dimension <code class="docutils literal"><span class="pre">frame[1920*1080*3]</span></code> (This
array is of fixed size regardless of the input source resolution).
1920x1080 is the maximum supported frame dimension and 3 separate values
for each pixel (Blue, Green, Red).</p>
<p>When the resolution is less than 1920x1080, the user must manually
extract the correct pixel data.</p>
<p>For example, if the resolution of the video input source is 800x600,
meaningful values will only be in the range <code class="docutils literal"><span class="pre">frame_raw[1920*i*3]</span></code> to
<code class="docutils literal"><span class="pre">frame_raw[(1920*i</span> <span class="pre">+</span> <span class="pre">799)*3]</span></code> for each <code class="docutils literal"><span class="pre">i</span></code> (rows) from 0 to 599. Any
other position outside of this range will contain invalid data.</p>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [13]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># printing the green component of pixel (0,0)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">frame_raw</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># printing the blue component of pixel (1,399)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">frame_raw</span><span class="p">[</span><span class="mi">1920</span> <span class="o">+</span> <span class="mi">399</span> <span class="o">+</span> <span class="mi">0</span><span class="p">])</span>

<span class="c1"># printing the red component of the last pixel (599,799)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">frame_raw</span><span class="p">[</span><span class="mi">1920</span><span class="o">*</span><span class="mi">599</span> <span class="o">+</span> <span class="mi">799</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="container">
</div>
<div class="container">
<div class="highlight"><pre>
175
227
249
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Frame-Lists">
<h2>Frame Lists<a class="headerlink" href="#Frame-Lists" title="Permalink to this headline">¶</a></h2>
<p>To draw or display smooth animations/video, note the following:</p>
<p>Draw a new frame to a frame location not currently in use (an index
different to the current <code class="docutils literal"><span class="pre">hdmi.frame_index()</span></code>) . Once finished writing
the new frame, change the current frame index to the new frame index.</p>
</div>
<div class="section" id="The-HDMI-out-controller">
<h2>The HDMI out controller<a class="headerlink" href="#The-HDMI-out-controller" title="Permalink to this headline">¶</a></h2>
<p>Using the HDMI output is similar to using the HDMI input. Connect the
HDMI OUT port to a monitor, or other display device.</p>
<p>To instantiate the HDMI controller:</p>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [14]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pynq.drivers</span> <span class="k">import</span> <span class="n">HDMI</span>

<span class="n">hdmi_out</span> <span class="o">=</span> <span class="n">HDMI</span><span class="p">(</span><span class="s1">&#39;out&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>For the HDMI controller, you have to start/stop the device explicitly:</p>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [15]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">hdmi_out</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [16]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">hdmi_out</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>To check the state of the controller:</p>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [17]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">state</span> <span class="o">=</span> <span class="n">hdmi_out</span><span class="o">.</span><span class="n">state</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="container">
</div>
<div class="container">
<div class="highlight"><pre>
0
</pre></div></div>
</div>
<p>The state is returned as an integer value, with 2 possible values:</p>
<ul class="simple">
<li>0 if stopped</li>
<li>1 if running</li>
</ul>
<p>After initialization, the display resolution is set at the lowest level:
640x480 at 60Hz.</p>
<p>To check the current resolution:</p>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [18]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">hdmi_out</span><span class="o">.</span><span class="n">mode</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="container">
</div>
<div class="container">
<div class="highlight"><pre>
640x480@60Hz
</pre></div></div>
</div>
<p>This will print the current mode as a string. To change the mode, insert
a valid index as an argument when calling mode():</p>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [19]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">hdmi_out</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>Out[19]:
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre>
<span></span>&#39;1920x1080@60Hz&#39;
</pre></div>
</div>
</div>
<p>Valid resolutions are:</p>
<ul class="simple">
<li>0 : 640x480, 60Hz</li>
<li>1 : 800x600, 60Hz</li>
<li>2 : 1280x720, 60Hz</li>
<li>3 : 1280x1024, 60Hz</li>
<li>4 : 1920x1080, 60Hz</li>
</ul>
</div>
<div class="section" id="Input/Output-Frame-Lists">
<h2>Input/Output Frame Lists<a class="headerlink" href="#Input/Output-Frame-Lists" title="Permalink to this headline">¶</a></h2>
<p>To draw or display smooth animations/video, note the following:</p>
<p>Draw a new frame to a frame location not currently in use (an index
different to the current <code class="docutils literal"><span class="pre">hdmi.frame_index()</span></code>) . Once finished writing
the new frame, change the current frame index to the new frame index.</p>
</div>
<div class="section" id="Streaming-from-HDMI-Input-to-Output">
<h2>Streaming from HDMI Input to Output<a class="headerlink" href="#Streaming-from-HDMI-Input-to-Output" title="Permalink to this headline">¶</a></h2>
<p>To use the HDMI input and output to capture and display an image, make
both the HDMI input and output share the same frame list. The frame list
in both cases can be accessed. You can make the two object share the
same frame list by a frame list as an argument to the second object’s
constructor.</p>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [20]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pynq.drivers.video</span> <span class="k">import</span> <span class="n">HDMI</span>

<span class="n">hdmi_in</span> <span class="o">=</span> <span class="n">HDMI</span><span class="p">(</span><span class="s1">&#39;in&#39;</span><span class="p">)</span>
<span class="n">hdmi_out</span> <span class="o">=</span> <span class="n">HDMI</span><span class="p">(</span><span class="s1">&#39;out&#39;</span><span class="p">,</span> <span class="n">frame_list</span><span class="o">=</span><span class="n">hdmi_in</span><span class="o">.</span><span class="n">frame_list</span><span class="p">)</span>
<span class="n">hdmi_out</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>Out[20]:
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre>
<span></span>&#39;1920x1080@60Hz&#39;
</pre></div>
</div>
</div>
<p>To start the controllers:</p>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [21]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">hdmi_out</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="n">hdmi_in</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>The last step is always to stop the controllers and delete HDMI objects.</p>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [22]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">hdmi_out</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="n">hdmi_in</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="k">del</span> <span class="n">hdmi_out</span>
<span class="k">del</span> <span class="n">hdmi_in</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="9c_base_overlay_audio.html" class="btn btn-neutral float-right" title="Audio using the Base Overlay" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="9a_base_overlay_iop.html" class="btn btn-neutral" title="Using Peripherals with the Base overlay" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Xilinx.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>