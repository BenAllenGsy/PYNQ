

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Programming PYNQ-Z1’s onboard peripherals &mdash; Python productivity for Zynq (Pynq) v1.0</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Python productivity for Zynq (Pynq) v1.0" href="index.html"/>
        <link rel="next" title="Introduction to Overlays" href="6_overlays.html"/>
        <link rel="prev" title="Cortex-A9 programming in Python" href="4_programming_python.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Python productivity for Zynq (Pynq)
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="1_getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_pynq.html">PYNQ Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_jupyter_notebook.html">Jupyter Notebook Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="4_programming_python.html">Cortex-A9 programming in Python</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Programming PYNQ-Z1&#8217;s onboard peripherals</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#LEDs,-switches-and-buttons">LEDs, switches and buttons</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Peripheral-Example">Peripheral Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Controlling-a-single-LED">Controlling a single LED</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Example:-Controlling-all-the-LEDs,-switches-and-buttons">Example: Controlling all the LEDs, switches and buttons</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="6_overlays.html">Introduction to Overlays</a></li>
<li class="toctree-l1"><a class="reference internal" href="7_iop_architecture.html">IO Processor Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="8_iop_code.html">IO Processors: Writing Your Own Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="9a_base_overlay_iop.html">Using Peripherals with the Base overlay</a></li>
<li class="toctree-l1"><a class="reference internal" href="9b_base_overlay_video.html">Video using the Base Overlay</a></li>
<li class="toctree-l1"><a class="reference internal" href="9c_base_overlay_audio.html">Audio using the Base Overlay</a></li>
<li class="toctree-l1"><a class="reference internal" href="10_creating_overlays.html">Creating Overlays</a></li>
<li class="toctree-l1"><a class="reference internal" href="11_python_package.html"><code class="docutils literal"><span class="pre">pynq</span></code> Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="12_verification.html">Verification</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html"><code class="docutils literal"><span class="pre">pynq</span></code> package reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="14_faqs.html">Frequently Asked Questions (FAQs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="15_glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="16_references.html">Useful Reference Links</a></li>
<li class="toctree-l1"><a class="reference internal" href="17_appendix.html">Appendix</a></li>
<li class="toctree-l1"><a class="reference internal" href="18_changelog.html">Documentation Changelog</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Python productivity for Zynq (Pynq)</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Programming PYNQ-Z1&#8217;s onboard peripherals</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/5_programming_onboard.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput > div,
div.nbinput div[class^=highlight],
div.nbinput div[class^=highlight] pre,
div.nboutput,
div.nboutput > div,
div.nboutput div[class^=highlight],
div.nboutput div[class^=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput > :first-child pre {
    color: navy;
}

/* output prompt */
div.nboutput > :first-child pre {
    color: darkred;
}

/* all prompts */
div.nbinput > :first-child[class^=highlight],
div.nboutput > :first-child[class^=highlight],
div.nboutput > :first-child {
    min-width: 11ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}

/* input/output area */
div.nbinput > :nth-child(2)[class^=highlight],
div.nboutput > :nth-child(2),
div.nboutput > :nth-child(2)[class^=highlight] {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
}

/* input area */
div.nbinput > :nth-child(2)[class^=highlight] {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput  > :nth-child(2).stderr {
    background: #fdd;
}

/* ANSI colors */
.ansiblack { color: black; }
.ansired { color: darkred; }
.ansigreen { color: darkgreen; }
.ansiyellow { color: #c4a000; }
.ansiblue { color: darkblue; }
.ansipurple { color: darkviolet; }
.ansicyan { color: steelblue; }
/* See https://github.com/jupyter/nbconvert/issues/174 */
.ansigray { color: gray; }  /* nbconvert CSS */
.ansigrey { color: gray; }  /* nbconvert HTML output */

.ansibgblack { background-color: black; }
.ansibgred { background-color: red; }
.ansibggreen { background-color: green; }
.ansibgyellow { background-color: yellow; }
.ansibgblue { background-color: blue; }
.ansibgpurple { background-color: magenta; }
.ansibgcyan { background-color: cyan; }
.ansibggray { background-color: gray; }

.ansibold { font-weight: bold; }
</style>
<div class="section" id="Programming-PYNQ-Z1's-onboard-peripherals">
<h1>Programming PYNQ-Z1&#8217;s onboard peripherals<a class="headerlink" href="#Programming-PYNQ-Z1's-onboard-peripherals" title="Permalink to this headline">¶</a></h1>
<div class="section" id="LEDs,-switches-and-buttons">
<h2>LEDs, switches and buttons<a class="headerlink" href="#LEDs,-switches-and-buttons" title="Permalink to this headline">¶</a></h2>
<p>PYNQ-Z1 has the following on-board LEDs, pushbuttons and switches:</p>
<ul class="simple">
<li>4 monochrome LEDs (LD3-LD0)</li>
<li>4 push-button switches (BTN3-BTN0)</li>
<li>2 RGB LEDs (LD5-LD4)</li>
<li>2 Slide-switches (SW1-SW0)</li>
</ul>
<p>The peripherals are highlighted in the image below.</p>
<div class="figure align-center">
<img alt="_images/pynqz1_board_io.JPG" src="_images/pynqz1_board_io.JPG" />
</div>
<p>All of these peripherals are connected to programmable logic. This means
controllers must be implemented in an overlay before these peripherals
can be used. The base overlay contains controllers for all of these
peripherals.</p>
<p>Note that there are additional push-buttons and LEDs on the board (e.g.
power LED, reset button). They are not user accessible, and are not
highlighted in the figure.</p>
</div>
<div class="section" id="Peripheral-Example">
<h2>Peripheral Example<a class="headerlink" href="#Peripheral-Example" title="Permalink to this headline">¶</a></h2>
<p>Using the base overlay, each of the highlighted devices can be
controlled using their corresponding pynq classes.</p>
<p>To demonstrate this, we will first download the base overlay to ensure
it is loaded, and then import the LED, RGBLED, Switch and Button classes
from the module <code class="docutils literal"><span class="pre">pynq.board</span></code>.</p>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pynq</span> <span class="k">import</span> <span class="n">Overlay</span>
<span class="kn">from</span> <span class="nn">pynq.board</span> <span class="k">import</span> <span class="n">LED</span>
<span class="kn">from</span> <span class="nn">pynq.board</span> <span class="k">import</span> <span class="n">RGBLED</span>
<span class="kn">from</span> <span class="nn">pynq.board</span> <span class="k">import</span> <span class="n">Switch</span>
<span class="kn">from</span> <span class="nn">pynq.board</span> <span class="k">import</span> <span class="n">Button</span>

<span class="n">Overlay</span><span class="p">(</span><span class="s2">&quot;base.bit&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">download</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Controlling-a-single-LED">
<h2>Controlling a single LED<a class="headerlink" href="#Controlling-a-single-LED" title="Permalink to this headline">¶</a></h2>
<p>Now we can instantiate objects of each of these classes and use their
methods to manipulate the corresponding peripherals. Let’s start by
instantiating a single LED and turning it on and off.</p>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">led0</span> <span class="o">=</span> <span class="n">LED</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">led0</span><span class="o">.</span><span class="n">on</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Check the board and confirm the LD0 is ON</p>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">led0</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Let’s then toggle <em>led0</em> using the sleep() method to see the LED
flashing.</p>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">pynq.board</span> <span class="k">import</span> <span class="n">LED</span>
<span class="kn">from</span> <span class="nn">pynq.board</span> <span class="k">import</span> <span class="n">Button</span>

<span class="n">led0</span> <span class="o">=</span> <span class="n">LED</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
    <span class="n">led0</span><span class="o">.</span><span class="n">toggle</span><span class="p">()</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Example:-Controlling-all-the-LEDs,-switches-and-buttons">
<h2>Example: Controlling all the LEDs, switches and buttons<a class="headerlink" href="#Example:-Controlling-all-the-LEDs,-switches-and-buttons" title="Permalink to this headline">¶</a></h2>
<p>The example below creates 3 separate lists, called leds, switches and
buttons.</p>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">MAX_LEDS</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">MAX_SWITCHES</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">MAX_BUTTONS</span> <span class="o">=</span> <span class="mi">4</span>

<span class="n">leds</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">MAX_LEDS</span>
<span class="n">switches</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">MAX_SWITCHES</span>
<span class="n">buttons</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">MAX_BUTTONS</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">MAX_LEDS</span><span class="p">):</span>
    <span class="n">leds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">LED</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">MAX_SWITCHES</span><span class="p">):</span>
    <span class="n">switches</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Switch</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">MAX_BUTTONS</span><span class="p">):</span>
    <span class="n">buttons</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>It will be useful to be able to turn off selected LEDs so we will create
a helper function to do that. It either clears the LEDs whose numbers we
list in the parameter, or by default clears LD3-LD0.</p>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Helper function to clear LEDs</span>
<span class="k">def</span> <span class="nf">clear_LEDs</span><span class="p">(</span><span class="n">LED_nos</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">MAX_LEDS</span><span class="p">))):</span>
    <span class="sd">&quot;&quot;&quot;Clear LEDS LD3-0 or the LEDs whose numbers appear in the list&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">LED_nos</span><span class="p">:</span>
        <span class="n">leds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>

<span class="n">clear_LEDs</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>First, all LEDs are set to off. Then each switch is read, and if in the
on position, the corresponding led is turned on. You can execute this
cell a few times, changing the position of the switches on the board.</p>
<ul class="simple">
<li>LEDs start in the off state</li>
<li>If SW0 is on, LD2 and LD0 will be on</li>
<li>If SW1 is on, LD3 and LD1 will be on</li>
</ul>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">clear_LEDs</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">MAX_LEDS</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">switches</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="k">2</span>].read():
        <span class="n">leds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">on</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">leds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>The last example toggles an led (on or off) if its corresponding push
button is pressed for so long as SW0 is switched on.</p>
<p>To end the program, slide SW0 to the off position.</p>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">time</span>

<span class="n">clear_LEDs</span><span class="p">()</span>

<span class="k">while</span> <span class="n">switches</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">MAX_LEDS</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">buttons</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">():</span>
            <span class="n">leds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">toggle</span><span class="p">()</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span>

<span class="n">clear_LEDs</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="6_overlays.html" class="btn btn-neutral float-right" title="Introduction to Overlays" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="4_programming_python.html" class="btn btn-neutral" title="Cortex-A9 programming in Python" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Xilinx.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>