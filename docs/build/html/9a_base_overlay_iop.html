

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Using Peripherals with the Base overlay &mdash; Python productivity for Zynq (Pynq) v1.0</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Python productivity for Zynq (Pynq) v1.0" href="index.html"/>
        <link rel="next" title="Video using the Base Overlay" href="9b_base_overlay_video.html"/>
        <link rel="prev" title="IO Processors: Writing Your Own Software" href="8_iop_code.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Python productivity for Zynq (Pynq)
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="1_getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_pynq.html">PYNQ Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_jupyter_notebook.html">Jupyter Notebook Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="4_programming_python.html">Cortex-A9 programming in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="5_programming_onboard.html">Programming PYNQ-Z1&#8217;s onboard peripherals</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_overlays.html">Introduction to Overlays</a></li>
<li class="toctree-l1"><a class="reference internal" href="7_iop_architecture.html">IO Processor Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="8_iop_code.html">IO Processors: Writing Your Own Software</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Using Peripherals with the Base overlay</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Base-overlay">Base overlay</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Using-Pmods-with-an-overlay">Using Pmods with an overlay</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Example:-Using-the-OLED-and-the-Ambient-Light-Sensor-(ALS)">Example: Using the OLED and the Ambient Light Sensor (ALS)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="9b_base_overlay_video.html">Video using the Base Overlay</a></li>
<li class="toctree-l1"><a class="reference internal" href="9c_base_overlay_audio.html">Audio using the Base Overlay</a></li>
<li class="toctree-l1"><a class="reference internal" href="10_creating_overlays.html">Creating Overlays</a></li>
<li class="toctree-l1"><a class="reference internal" href="11_python_package.html"><code class="docutils literal"><span class="pre">pynq</span></code> Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="12_verification.html">Verification</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html"><code class="docutils literal"><span class="pre">pynq</span></code> package reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="14_faqs.html">Frequently Asked Questions (FAQs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="15_glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="16_references.html">Useful Reference Links</a></li>
<li class="toctree-l1"><a class="reference internal" href="17_appendix.html">Appendix</a></li>
<li class="toctree-l1"><a class="reference internal" href="18_changelog.html">Documentation Changelog</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Python productivity for Zynq (Pynq)</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Using Peripherals with the Base overlay</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/9a_base_overlay_iop.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput > div,
div.nbinput div[class^=highlight],
div.nbinput div[class^=highlight] pre,
div.nboutput,
div.nboutput > div,
div.nboutput div[class^=highlight],
div.nboutput div[class^=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput > :first-child pre {
    color: navy;
}

/* output prompt */
div.nboutput > :first-child pre {
    color: darkred;
}

/* all prompts */
div.nbinput > :first-child[class^=highlight],
div.nboutput > :first-child[class^=highlight],
div.nboutput > :first-child {
    min-width: 11ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}

/* input/output area */
div.nbinput > :nth-child(2)[class^=highlight],
div.nboutput > :nth-child(2),
div.nboutput > :nth-child(2)[class^=highlight] {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
}

/* input area */
div.nbinput > :nth-child(2)[class^=highlight] {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput  > :nth-child(2).stderr {
    background: #fdd;
}

/* ANSI colors */
.ansiblack { color: black; }
.ansired { color: darkred; }
.ansigreen { color: darkgreen; }
.ansiyellow { color: #c4a000; }
.ansiblue { color: darkblue; }
.ansipurple { color: darkviolet; }
.ansicyan { color: steelblue; }
/* See https://github.com/jupyter/nbconvert/issues/174 */
.ansigray { color: gray; }  /* nbconvert CSS */
.ansigrey { color: gray; }  /* nbconvert HTML output */

.ansibgblack { background-color: black; }
.ansibgred { background-color: red; }
.ansibggreen { background-color: green; }
.ansibgyellow { background-color: yellow; }
.ansibgblue { background-color: blue; }
.ansibgpurple { background-color: magenta; }
.ansibgcyan { background-color: cyan; }
.ansibggray { background-color: gray; }

.ansibold { font-weight: bold; }
</style>
<div class="section" id="Using-Peripherals-with-the-Base-overlay">
<h1>Using Peripherals with the Base overlay<a class="headerlink" href="#Using-Peripherals-with-the-Base-overlay" title="Permalink to this headline">¶</a></h1>
<div class="section" id="Base-overlay">
<h2>Base overlay<a class="headerlink" href="#Base-overlay" title="Permalink to this headline">¶</a></h2>
<p>The PYNQ-Z1 has 2 Pmod connectors. PMODA and PMODB as indicated below
are connected to the FPGA fabric.</p>
<div class="figure align-center">
<img alt="_images/pynqz1_pmod_interface1.jpg" src="_images/pynqz1_pmod_interface1.jpg" />
</div>
</div>
<div class="section" id="Using-Pmods-with-an-overlay">
<h2>Using Pmods with an overlay<a class="headerlink" href="#Using-Pmods-with-an-overlay" title="Permalink to this headline">¶</a></h2>
<p>To use a peripheral two software components are required; a driver
application written in C for the IOP, and a Python module. These
components are provided as part of the Pynq package for supported
peripherals. See the <em>IO Processors: Writing your own software</em> section
of the documentation for writing drivers for your own peripherals.</p>
<p>The Python module instantiates the peripheral, and loads the driver
application to the appropriate IOP. The IOP will also be reset and start
executing the new application.</p>
<p>The Python module will send commands which the IOP will interpret and
execute. The Python module may also send the data if necessary. The IOP
will read from and write data into the shared memory area.</p>
</div>
<div class="section" id="Example:-Using-the-OLED-and-the-Ambient-Light-Sensor-(ALS)">
<h2>Example: Using the OLED and the Ambient Light Sensor (ALS)<a class="headerlink" href="#Example:-Using-the-OLED-and-the-Ambient-Light-Sensor-(ALS)" title="Permalink to this headline">¶</a></h2>
<p>This examples requires the PmodOLED (OLED), and PmodALS (Ambient Light
Sensor). Plug the PmodALS into PMODA, and PmodOLED into the top row of
PMODB. (Currently, the PmodALS can only be used in the top row of a Pmod
port.)</p>
<p>OLED displaying light reading from ambient light sensor:</p>
<div class="figure align-center">
<img alt="_images/als_oled_demo.JPG" src="_images/als_oled_demo.JPG" />
</div>
<p>Execute the next cell to load the FPGA fabric with the desired overlay,
and then import the OLED module and instantiate it on PMODB:</p>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pynq</span> <span class="k">import</span> <span class="n">Overlay</span>
<span class="kn">from</span> <span class="nn">pynq.iop</span> <span class="k">import</span> <span class="n">Pmod_OLED</span>
<span class="kn">from</span> <span class="nn">pynq.iop</span> <span class="k">import</span> <span class="n">PMODB</span>

<span class="n">ol</span> <span class="o">=</span> <span class="n">Overlay</span><span class="p">(</span><span class="s2">&quot;base.bit&quot;</span><span class="p">)</span>
<span class="n">ol</span><span class="o">.</span><span class="n">download</span><span class="p">()</span>
<span class="n">oled</span> <span class="o">=</span> <span class="n">Pmod_OLED</span><span class="p">(</span><span class="n">PMODB</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Try writing a message to the OLED.</p>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">oled</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Hello World&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">oled</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Import the ALS library, create an instance of the ALS Pmod, and read the
value from the sensor.</p>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pynq.iop</span> <span class="k">import</span> <span class="n">Pmod_ALS</span>
<span class="kn">from</span> <span class="nn">pynq.iop</span> <span class="k">import</span> <span class="n">PMODA</span>

<span class="n">als</span> <span class="o">=</span> <span class="n">Pmod_ALS</span><span class="p">(</span><span class="n">PMODA</span><span class="p">)</span>
<span class="n">als</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>Out[4]:
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre>
<span></span>255
</pre></div>
</div>
</div>
<p>Write the value from the ALS to the OLED. The ALS sensor returns an
8-bit value.</p>
<ul class="simple">
<li>0 : Darkest</li>
<li>255 : Brightest</li>
</ul>
<div class="nbinput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">oled</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Light value : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">als</span><span class="o">.</span><span class="n">read</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">pynq.iop</span> <span class="k">import</span> <span class="n">Pmod_ALS</span>
<span class="kn">from</span> <span class="nn">pynq.iop</span> <span class="k">import</span> <span class="n">PMODA</span>

<span class="n">als</span> <span class="o">=</span> <span class="n">Pmod_ALS</span><span class="p">(</span><span class="n">PMODA</span><span class="p">)</span>

<span class="n">als</span><span class="o">.</span><span class="n">set_log_interval_ms</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">als</span><span class="o">.</span><span class="n">start_log</span><span class="p">()</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">als</span><span class="o">.</span><span class="n">stop_log</span><span class="p">()</span>
<span class="n">als</span><span class="o">.</span><span class="n">get_log</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>Out[6]:
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre>
<span></span>[255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
</pre></div>
</div>
</div>
<p>For information on other supported peripherals and their API, see the
<em>pynq.iop package</em> section of the documentation.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="9b_base_overlay_video.html" class="btn btn-neutral float-right" title="Video using the Base Overlay" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="8_iop_code.html" class="btn btn-neutral" title="IO Processors: Writing Your Own Software" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Xilinx.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>